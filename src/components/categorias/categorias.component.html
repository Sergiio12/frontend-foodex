<!-- categorias.component.html -->
<app-header></app-header>

<main class="main-content">
  <!-- Estado de carga -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner-container">
      <div class="spinner"></div>
      <p class="loading-text">Cargando categorías...</p>
    </div>
  </div>

  <!-- Manejo de errores -->
  <div *ngIf="errorMessage && !isLoading" class="error-container">
    <div class="error-card">
      <div class="error-icon-container">
        <svg class="error-icon" viewBox="0 0 24 24">
          <path fill="currentColor" d="M11 15h2v2h-2zm0-8h2v6h-2zm1-5C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 18a8 8 0 0 1-8-8a8 8 0 0 1 8-8a8 8 0 0 1 8 8a8 8 0 0 1-8 8"/>
        </svg>
      </div>
      <h3 class="error-title">¡Ups! Algo salió mal</h3>
      <p class="error-message">{{ errorMessage }}</p>
      <button class="retry-button" (click)="loadCategorias()">
        Reintentar
        <svg class="retry-icon" viewBox="0 0 24 24">
          <path fill="currentColor" d="M12 5V1L7 6l5 5V7c3.3 0 6 2.7 6 6s-2.7 6-6 6s-6-2.7-6-6H4c0 4.4 3.6 8 8 8s8-3.6 8-8s-3.6-8-8-8"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Contenido principal -->
  <div *ngIf="!isLoading && !errorMessage" class="categorias-grid">
    <div class="section-header">
      <h1 class="section-title">Explora Nuestras Categorías</h1>
      <p class="section-subtitle">Descubre una selección única de productos cuidadosamente seleccionados</p>
    </div>
    
    <div class="grid-container">
      <article class="categoria-card" 
           *ngFor="let categoria of categorias"
           (mouseenter)="hoverState = categoria.id"
           (mouseleave)="hoverState = null"
           [class.card-hover]="hoverState === categoria.id">
        <div class="card-inner">
          <div class="image-wrapper">
            <!-- Usamos la propiedad 'imagenUrl' ya que el servicio mapea la URL completa -->
            <img [src]="categoria.imgUrl" 
                 [alt]="categoria.nombre" 
                 class="categoria-image"
                 [class.image-zoom]="hoverState === categoria.id"
                 loading="lazy">
            <div class="image-overlay"></div>
            
            <!-- Botón de edición para ADMIN -->
            <button *ngIf="hasAdminRole()" class="edit-button" (click)="editCategoria(categoria)">
              <svg class="edit-icon" viewBox="0 0 24 24">
                <path fill="currentColor" d="M20.7 7c.4-.4.4-1 0-1.4l-2.3-2.3c-.4-.4-1-.4-1.4 0l-1.8 1.8L19 8.1M3 17.2V21h3.8l11-11.1l-3.7-3.8L3 17.2"/>
              </svg>
            </button>
          </div>
          
          <div class="card-content">
            <div class="text-content">
              <h3 class="categoria-title">{{ categoria.nombre }}</h3>
              <p class="categoria-description">{{ categoria.descripcion }}</p>
            </div>
            <button class="explore-button">
              Ver productos
              <svg class="arrow-icon" viewBox="0 0 24 24">
                <path fill="currentColor" d="M4 11v2h12l-5.5 5.5l1.4 1.4l7.9-7.9l-7.9-7.9l-1.4 1.4L16 11H4"/>
              </svg>
            </button>
          </div>
        </div>
      </article>
    </div>
  </div>
</main>

<app-footer></app-footer>
